---
title: "Sentiment dashboard for computationally challenged Helge"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
source("../code/install_libs.R")
```

Frequency
=======================================================================
Column {data-width=550}
-----------------------------------------------------------------------

### Noun Frequency (top 50)

```{r}
  noun_freq = read.csv("../data/noun_freq.csv")
  nounFreq_30 = noun_freq[(1:50),]
  
  ggplot(nounFreq_30, aes(x = reorder(lemma, n), y = n)) +
    geom_bar(stat = "identity") +
    coord_flip()
```

Column {data-width=550}
-----------------------------------------------------------------------

### Adjective frequency (top 50)

```{r}
  adjFreq = read.csv("../data/adj_freq.csv")
  adjFreq = adjFreq[(1:50),]
  
  ggplot(adjFreq, aes(x = reorder(lemma, n), y = n)) +
    geom_bar(stat = "identity") +
    coord_flip()
```

Frequency (2)
=======================================================================

Column {data-width=550}
-----------------------------------------------------------------------

### Nounphrase frequency with stop words (top 50)
```{r}
nounphrase = read.csv("../data/nounphrase_freq.csv")
nounphrase = nounphrase[(1:50),]
ggplot(nounphrase, aes(x=reorder(text, n), y = n)) +
  geom_bar(stat = "identity") +
  coord_flip()
```

Column {data-width=550}
-----------------------------------------------------------------------

### Nounphrase frequency without stop words  (top 50)
```{r}
nounphrase = read.csv("../data/nounphrase_freq_clean.csv")
nounphrase = nounphrase[(1:50),]
ggplot(nounphrase, aes(x=reorder(text, n), y = n)) +
  geom_bar(stat = "identity") +
  coord_flip()

```

Sentiment frequency
=======================================================================

Column {data-width=550}
-----------------------------------------------------------------------

### Emo_lex freq (top 50)
```{r}
  emo_lex_freq = read.csv("../data/emo_lex_freq.csv")
  emo_lex_freq = emo_lex_freq[(1:30), ]
  
  ggplot(emo_lex_freq, aes(x = reorder(tt, Freq), y = Freq)) +
    geom_bar(stat = "identity") +
    coord_flip()
```


```{r}
plot_cluster_senti_freq = function(topic_n)
{
  k6_topic_1_pollution = tweets_primary_df %>% 
    filter(`key_topic topic(k=5)` == topic_n) %>%
    summarise(across(anticipation:joy, ~ sum(.x, na.rm = TRUE))) %>%
    select(-c(positive, negative)) %>%
    gather()
  ggplot(k6_topic_1_pollution, aes(x = reorder(key, value), y = value)) +
    geom_bar(stat = "identity") +
    coord_flip()
}
plot_cluster_senti_freq(topic_n = 1)
plot_cluster_senti_freq(topic_n = 2)
plot_cluster_senti_freq(topic_n = 3)
plot_cluster_senti_freq(topic_n = 4)
plot_cluster_senti_freq(topic_n = 5)
```